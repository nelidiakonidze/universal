language: node_js
node_js: 
  - '12'


install: 
    - git remote add upstream https://github.com/nelidiakonidze/universal.git
    - git fetch upstream master
    - yarn

cache:
  yarn: true
  directories:
    - node_modules

  
matrix:
    include:
      - stage: test
        script: 
        - if [ $TRAVIS_BRANCH == "master" ] || [[ -n "$TRAVIS_TAG" ]]; then
          ng lint;
          else
          yarn affected:lint --base=upstream/master --head=$TRAVIS_BRANCH;
          fi
         
         - if [ $TRAVIS_BRANCH == "master" ] || [[ -n "$TRAVIS_TAG" ]]; then
          ng test --maxWorkers=2;
          else
          yarn affected:test --base=upstream/master --head=$TRAVIS_BRANCH --maxWorkers=2;
          fi
        
         - if [ $TRAVIS_BRANCH == "master" ] || [[ -n "$TRAVIS_TAG" ]]; then
            yarn coverage-runner;
            fi
  